---
- name: Find out which python version is avaible
  hosts: all
  gather_facts: false
  remote_user: "{{ username }}"
  tasks:
    - name: Check if python2 is available
      raw: python2 --version
      args:
        executable: /bin/bash
      register: python_exist
      ignore_errors: yes
      changed_when: false

    - name: Use python3 as the ansible interpreter if python2 is unavailable
      set_fact:
        ansible_python_interpreter: /usr/bin/python3
      when: "'not installed' in python_exist.stdout or 'not found' in python_exist.stdout"

- name: Install docker
  hosts: all
  remote_user: "{{ username }}"
  become: true
  roles:
    - docker
